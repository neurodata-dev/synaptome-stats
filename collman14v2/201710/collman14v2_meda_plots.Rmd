---
title: "Collman14v2 Data: annotated voxels"
date: '`r Sys.Date()`'
output:
  html_document:
    fig_caption: yes
    fig_height: 5
    fig_width: 5
    highlight: pygments
    number_sections: yes
    theme: cerulean
    toc: yes
    toc_depth: 1
---
```{r knitOPTS, include=FALSE}
knitr::opts_chunk$set(cache = TRUE, dev = "png")
```

```{r render, eval=FALSE, echo=FALSE}
require(rmarkdown)
rmarkdown::render("collman14v2_meda_plots.Rmd")
system("open collman14v2_meda_plots.html")
```

```{r setup,include=FALSE,results='asis',message=FALSE,warning=FALSE, echo = FALSE}
# Library calls here.
require(rmarkdown)
require(knitr)
suppressMessages(require(meda))
```

## Make plots

```{r, eval = FALSE}
perm <- c(1,2,3,4,5,10,6,7,8,9,11)
tight <- read.csv("collman14v2_F0_tight_annotations.csv")[perm]
stight <- scale(tight, center = TRUE, scale = TRUE)

ccol <- c('blue', 'blue', 'blue', 'red', 'red', 
          'red', 'green', 'green', 'green', 'red', 
          'green')[perm]

set.seed(317)
Lt <- runAll(stight, ccol = ccol)
Lt[[1]] <- mlocation(tight, ccol = ccol)

w = 720
h = 720 

png("d1heat.png", width = w, height = h)
p1 <- plot(Lt[[2]]) 
show(p1)
dev.off()

png("mlocation.png", width = w, height = 0.5*h)
p1 <- plot(Lt[[1]]) 
show(p1)
dev.off()

png("cumulativeVariance.png", width = w, height = h)
p1 <- plot(Lt[[3]]) 
show(p1)
dev.off()

png("outliers.png", width = w, height = h)
p1 <- plot(Lt[[4]]) 
show(p1)
dev.off()

png("cor.png", width = w, height = h)
plot(Lt[[6]]) 
dev.off()

png("pairhexTight.png", width = 2*w, height = 2*h)
pairhex(stight)
dev.off()


png("hmcClassificationsTight.png", width = 2*w, height = 2*h)
cr <- viridis(max(Lt[[7]]$dat$labels$col))
pairs(Lt[[7]]$dat$data, pch = 19, cex = 0.5, col = cr[Lt[[7]]$dat$labels$col])
dev.off()


png("dendrograms.png", width = w, height = h)
plotDend(Lt[[7]])
dev.off()

png("stackMeans.png", width = w, height = 2*h)
p1 <- stackM(Lt[[7]], ccol = ccol, depth = 3, centered = TRUE)
show(p1)
dev.off()

png("clusterMeans.png", width = w, height = h)
p1 <- clusterMeans(Lt[[7]], ccol = ccol)
show(p1)
dev.off()
```

# Tight F0 plots

## 1-d Heatmap
![](./d1heat.png)

## Location meda_plots
![](./mlocation.png)

## Outliers as given by randomForest
![](./outliers.png)

## Correlation Matrix
![](./cor.png)

## Cumulative Variance with Elbows
![](./cumulativeVariance.png)

## Paired Hex-binned plot
![](./pairhexTight.png)

## Hierarchical GMM Classifications
![](./hmcClassificationsTight.png)

## Hierarchical GMM Dendrogram
![](./dendrograms.png)

## Stacked Means
![](./stackMeans.png)

## Cluster Means
![](./clusterMeans.png)



--- 
---
