# Synaptome Stats: Marker Exploration
Jesse Leigh Patsolic  
`r Sys.Date()`  





[Homepage](http://docs.neurodata.io/synaptome-stats/)  
The formatted source code for this file is [here](https://github.com/neurodata/synaptome-stats/blob/gh-pages/Code/MarkerExploration.Rmd).  
And a raw version [here](https://raw.githubusercontent.com/neurodata/synaptome-stats/gh-pages/Code/MarkerExploration.Rmd).    
Previous work by Youngser Park can be found [here](http://www.cis.jhu.edu/~parky/Synapse/synapse.html).  

# Data 

Here we read in the data and select a random half of it for exploration. 


```r
featFull <- fread("../data/synapsinR_7thA.tif.Pivots.txt.2011Features.txt",showProgress=FALSE)

### Setting a seed and creating an index vector
### to select half of the data
set.seed(2^10)
half1 <- sample(dim(featFull)[1],dim(featFull)[1]/2)
half2 <- setdiff(1:dim(featFull)[1],half1)

feat <- featFull[half1,]
dim(feat)
```

```
# [1] 559649    144
```

```r
## Setting the channel names
channel <- c('Synap_1','Synap_2','VGlut1_t1','VGlut1_t2','VGlut2','Vglut3',
              'psd','glur2','nmdar1','nr2b','gad','VGAT',
              'PV','Gephyr','GABAR1','GABABR','CR1','5HT1A',
              'NOS','TH','VACht','Synapo','tubuli','DAPI')

## Setting the channel types
channel.type <- c('ex.pre','ex.pre','ex.pre','ex.pre','ex.pre','in.pre.small',
                  'ex.post','ex.post','ex.post','ex.post','in.pre','in.pre',
                  'in.pre','in.post','in.post','in.post','in.pre.small','other',
                  'ex.post','other','other','ex.post','none','none')

channel.type2 <- c('ex.pre','ex.pre','ex.pre','ex.pre','ex.pre','other',
                   'ex.post','ex.post','ex.post','ex.post','in.pre','in.pre',
                   'in.pre','in.post','in.post','in.post','other','other',
                   'ex.post','other','other','ex.post','other','other')
nchannel <- length(channel)
nfeat <- ncol(feat) / nchannel

## Createing factor variables for channel and channel type sorted properly
ffchannel <- (factor(channel.type,
    levels= c("ex.pre","ex.post","in.pre","in.post","in.pre.small","other","none")
    ))
fchannel <- as.numeric(factor(channel.type,
    levels= c("ex.pre","ex.post","in.pre","in.post","in.pre.small","other","none")
    ))
ford <- order(fchannel)


## Setting up colors for channel types
Syncol <-  c("#197300","#5ed155","#660000","#cc0000","#ff9933","#0000cd","#ffd700")
Syncol3 <- c("#197300","#197300","#cc0000","#cc0000","#0000cd","#0000cd","#0000cd")
ccol <- Syncol[fchannel]
ccol3 <- Syncol3[fchannel]

exType <- factor(c(rep("ex",11),rep("in",6),rep("other",7)),ordered=TRUE)
exCol<-exType;levels(exCol) <- c("#197300","#990000","#0000cd");
exCol <- as.character(exCol)

fname <- as.vector(sapply(channel,function(x) paste0(x,paste0("F",0:5))))
names(feat) <- fname
fcol <- rep(ccol, each=6)
mycol <- colorpanel(100, "purple", "black", "green")
mycol2 <- matlab.like(nchannel)
mycol3 <- colorpanel(100, "blue","white","red")
```

## Data transformations


```r
f <- lapply(1:6,function(x){seq(x,ncol(feat),by=nfeat)})
featF <- lapply(f,function(x){subset(feat,select=x)})

featF0 <- featF[[1]]
f01e3 <- 1e3*data.table(apply(X=featF0,2,function(x){((x-min(x))/(max(x)-min(x)))}))

fs <- f01e3

### Taking log_10 on data + 1.
log1f <- log10(featF0 + 1)
slog1f <- data.table(scale(log1f, center=TRUE,scale=TRUE))
```

We now have the following data sets:

- `featF0`: The feature vector looking only at the integrated brightness features.
- `fs`:  The feature vector scaled between $[0,1000]$.
- `logf1`: The feature vector, plus one, then $log_{10}$ is applied. 
- `slog1f`: The feature vector, plus one, $log_{10}$, then scaled by
  subtracting the mean and dividing by the sample standard deviation.

# Marker Exploration 

## Correlation Matrix of markers 


```r
corrf <- cor(featF[[1]])[ford,ford]
corrplot(corrf,method="color",tl.col=ccol[ford], tl.cex=0.8)
```

<figure><img src="../Figures/MarkerExploration_figure/cc_corRawF0-1.png"><figcaption><b>Figure 1: Correlation on untransformed F0 data, reordered by synapse type.</b><br><br></figcaption></figure>

```r
corLog <- cor(slog1f)
```

## Energy Matrix: Distance Correlation T-test


```r
set.seed(317)
sam1 <- sample(dim(featF0)[1], 1e3)
tmp <- as.data.frame((featF0[sam1,]))

set.seed(331)
combcols <- t(combn(24,2))

dc <- foreach(i = 1:dim(combcols)[1]) %dopar% {
       #dcov.test(x=tmp[,combcols[i,1]],y=tmp[,combcols[i,2]])
       dcor.ttest(x=tmp[,combcols[i,1]],y=tmp[,combcols[i,2]])
       }

ms <- matrix(as.numeric(0),24,24)
mp <- matrix(as.numeric(0),24,24)

for(i in 1:length(dc)){
    ms[combcols[i,1],combcols[i,2]] <- dc[[i]]$statistic
    ms[combcols[i,2],combcols[i,1]] <- dc[[i]]$statistic
    mp[combcols[i,1],combcols[i,2]] <- dc[[i]]$p.val
    mp[combcols[i,2],combcols[i,1]] <- dc[[i]]$p.val
}

rownames(ms) <- colnames(featF0)
rownames(mp) <- colnames(featF0)
colnames(ms) <- colnames(featF0)
colnames(mp) <- colnames(featF0)

diag(ms) <- as.numeric(0)
diag(mp) <- as.numeric(1)
```


```r
cl5 <- colorRampPalette(c("white", "blue"))
bl5 <- colorRampPalette(c("blue", "red"))

par(mfrow=c(1,2))
tmp <- as.numeric(table(fchannel))
corrplot(ms[ford,ford],is.corr=FALSE,method="color",tl.col=ccol[ford], 
         tl.cex=0.8, mar=c(0,0,1,0),oma=c(0,0,2,0))
title("Test statistic") 
corrRect(tmp,col=Syncol,lwd=4)


corrplot((mp[ford,ford]),is.corr=FALSE,method="color",tl.col=ccol[ford], 
         tl.cex=0.8,col=mycol3[-c(1:2)], mar=c(0,0,1,0),
         p.mat=mp[ford,ford], sig.level=0.05)
title("p-values")
corrRect(tmp,col=Syncol,lwd=4);rm(tmp)
```

<figure><img src="../Figures/MarkerExploration_figure/cc-energyplot-1.png"><figcaption><b>Figure 2: F0: Distance correlation t-test statistic and p-value matrices.</b><br><br></figcaption></figure>
The `X`'s in the above right figure denote a p-value greater than 0.05.

## Scatterplots 

We will run PCA on the untransformed correlation matrix so the data can be 
viewed in 2-dimensions.  The colors correspond to synapse type.


```r
pca1 <- prcomp(corrf,center=TRUE, scale=TRUE)
pairs(pca1$x[,1:3], col=ccol3[ford],pch=20, cex=2)
```

<figure><img src="../Figures/MarkerExploration_figure/cc-pca1-1.png"><figcaption><b>Figure 3: PCA of untransformed correlation matrix</b><br><br></figcaption></figure>



```r
pca <- pca1$x
rgl::plot3d(pca[,1],pca[,2],pca[,3],type='s',col=ccol3[ford], size=1)
rgl::rgl.texts(pca[,1],pca[,2],pca[,3],abbreviate(rownames(pca)), col=ccol3[ford], adj=c(0,2))
subid <- currentSubscene3d()
rglwidget(elementId="rgl-pca1",width=720,height=720)
```

<!--html_preserve--><div id="rgl-pca1" style="width:720px;height:720px;" class="rglWebGL html-widget"></div>
<script type="application/json" data-for="rgl-pca1">{"x":{"material":{"color":["#197300","#197300","#197300","#197300","#197300","#197300","#197300","#197300","#197300","#197300","#197300","#CC0000","#CC0000","#CC0000","#CC0000","#CC0000","#CC0000","#0000CD","#0000CD","#0000CD","#0000CD","#0000CD","#0000CD","#0000CD"],"alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less"},"rootSubscene":1,"objects":{"7":{"id":7,"type":"spheres","material":{"fog":false},"vertices":[[-3.83670377731323,-1.5738183259964,1.40753543376923],[-2.50157380104065,-2.14191365242004,1.87620329856873],[-4.5821418762207,-0.792968809604645,0.779203355312347],[-4.51670217514038,-0.67347639799118,0.683327794075012],[-0.526551365852356,0.426422983407974,-0.646630764007568],[-3.9575936794281,-0.212373957037926,-0.105615541338921],[-2.71547174453735,0.339899390935898,-0.719722628593445],[-1.11999690532684,0.673265337944031,-2.63924407958984],[-1.31165075302124,0.753459632396698,-2.38941192626953],[0.400413066148758,0.902173280715942,-1.58194077014923],[1.06597316265106,3.58027625083923,1.90600061416626],[4.56618165969849,-2.43079662322998,0.697836458683014],[4.2729754447937,-2.5679657459259,0.80644679069519],[3.32899951934814,-1.44997847080231,0.246566891670227],[3.03064513206482,-1.84786176681519,-0.154282882809639],[1.90041708946228,-1.2919487953186,-0.601159393787384],[-3.12665748596191,-0.435760140419006,0.158417627215385],[1.42735993862152,0.0395337864756584,-1.10691320896149],[1.7144820690155,2.03149747848511,1.09275341033936],[1.09005117416382,1.03411567211151,1.39296543598175],[0.75717967748642,0.197984218597412,-1.10256361961365],[1.5859854221344,3.24714541435242,2.08960151672363],[1.47113263607025,0.415414959192276,-1.94746458530426],[1.58324754238129,1.77767419815063,-0.141909316182137]],"colors":[[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.800000011920929,0,0,1],[0.800000011920929,0,0,1],[0.800000011920929,0,0,1],[0.800000011920929,0,0,1],[0.800000011920929,0,0,1],[0.800000011920929,0,0,1],[0,0,0.803921580314636,1],[0,0,0.803921580314636,1],[0,0,0.803921580314636,1],[0,0,0.803921580314636,1],[0,0,0.803921580314636,1],[0,0,0.803921580314636,1],[0,0,0.803921580314636,1]],"radii":[[0.115411780774593]],"centers":[[-3.83670377731323,-1.5738183259964,1.40753543376923],[-2.50157380104065,-2.14191365242004,1.87620329856873],[-4.5821418762207,-0.792968809604645,0.779203355312347],[-4.51670217514038,-0.67347639799118,0.683327794075012],[-0.526551365852356,0.426422983407974,-0.646630764007568],[-3.9575936794281,-0.212373957037926,-0.105615541338921],[-2.71547174453735,0.339899390935898,-0.719722628593445],[-1.11999690532684,0.673265337944031,-2.63924407958984],[-1.31165075302124,0.753459632396698,-2.38941192626953],[0.400413066148758,0.902173280715942,-1.58194077014923],[1.06597316265106,3.58027625083923,1.90600061416626],[4.56618165969849,-2.43079662322998,0.697836458683014],[4.2729754447937,-2.5679657459259,0.80644679069519],[3.32899951934814,-1.44997847080231,0.246566891670227],[3.03064513206482,-1.84786176681519,-0.154282882809639],[1.90041708946228,-1.2919487953186,-0.601159393787384],[-3.12665748596191,-0.435760140419006,0.158417627215385],[1.42735993862152,0.0395337864756584,-1.10691320896149],[1.7144820690155,2.03149747848511,1.09275341033936],[1.09005117416382,1.03411567211151,1.39296543598175],[0.75717967748642,0.197984218597412,-1.10256361961365],[1.5859854221344,3.24714541435242,2.08960151672363],[1.47113263607025,0.415414959192276,-1.94746458530426],[1.58324754238129,1.77767419815063,-0.141909316182137]],"ignoreExtent":false,"flags":3},"9":{"id":9,"type":"text","material":{"lit":false,"fog":false},"vertices":[[-0.0079801082611084,-3.74730086326599,-3.54631543159485]],"colors":[[0,0,0,1]],"texts":[["pca[, 1]"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.0079801082611084,-3.74730086326599,-3.54631543159485]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":40},"10":{"id":10,"type":"text","material":{"lit":false,"fog":false},"vertices":[[-6.33694267272949,0.506155252456665,-3.54631543159485]],"colors":[[0,0,0,1]],"texts":[["pca[, 2]"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-6.33694267272949,0.506155252456665,-3.54631543159485]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":40},"11":{"id":11,"type":"text","material":{"lit":false,"fog":false},"vertices":[[-6.33694267272949,-3.74730086326599,-0.274821281433105]],"colors":[[0,0,0,1]],"texts":[["pca[, 3]"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-6.33694267272949,-3.74730086326599,-0.274821281433105]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":40},"12":{"id":12,"type":"text","material":{"lit":false},"vertices":[[-3.83670377731323,-1.5738183259964,1.40753543376923],[-2.50157380104065,-2.14191365242004,1.87620329856873],[-4.5821418762207,-0.792968809604645,0.779203355312347],[-4.51670217514038,-0.67347639799118,0.683327794075012],[-0.526551365852356,0.426422983407974,-0.646630764007568],[-3.9575936794281,-0.212373957037926,-0.105615541338921],[-2.71547174453735,0.339899390935898,-0.719722628593445],[-1.11999690532684,0.673265337944031,-2.63924407958984],[-1.31165075302124,0.753459632396698,-2.38941192626953],[0.400413066148758,0.902173280715942,-1.58194077014923],[1.06597316265106,3.58027625083923,1.90600061416626],[4.56618165969849,-2.43079662322998,0.697836458683014],[4.2729754447937,-2.5679657459259,0.80644679069519],[3.32899951934814,-1.44997847080231,0.246566891670227],[3.03064513206482,-1.84786176681519,-0.154282882809639],[1.90041708946228,-1.2919487953186,-0.601159393787384],[-3.12665748596191,-0.435760140419006,0.158417627215385],[1.42735993862152,0.0395337864756584,-1.10691320896149],[1.7144820690155,2.03149747848511,1.09275341033936],[1.09005117416382,1.03411567211151,1.39296543598175],[0.75717967748642,0.197984218597412,-1.10256361961365],[1.5859854221344,3.24714541435242,2.08960151672363],[1.47113263607025,0.415414959192276,-1.94746458530426],[1.58324754238129,1.77767419815063,-0.141909316182137]],"colors":[[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.0980392172932625,0.450980395078659,0,1],[0.800000011920929,0,0,1],[0.800000011920929,0,0,1],[0.800000011920929,0,0,1],[0.800000011920929,0,0,1],[0.800000011920929,0,0,1],[0.800000011920929,0,0,1],[0,0,0.803921580314636,1],[0,0,0.803921580314636,1],[0,0,0.803921580314636,1],[0,0,0.803921580314636,1],[0,0,0.803921580314636,1],[0,0,0.803921580314636,1],[0,0,0.803921580314636,1]],"texts":[["S_1F"],["S_2F"],["VG1_1"],["VG1_2"],["VG2F"],["psF0"],["g2F0"],["n1F0"],["n2F0"],["NOSF"],["SyF0"],["gdF0"],["VGAT"],["PVF0"],["GpF0"],["GABAR"],["GABAB"],["V3F0"],["CR1F"],["5HT1"],["THF0"],["VACF"],["tbF0"],["DAPI"]],"cex":[[1]],"adj":[[0,2]],"centers":[[-3.83670377731323,-1.5738183259964,1.40753543376923],[-2.50157380104065,-2.14191365242004,1.87620329856873],[-4.5821418762207,-0.792968809604645,0.779203355312347],[-4.51670217514038,-0.67347639799118,0.683327794075012],[-0.526551365852356,0.426422983407974,-0.646630764007568],[-3.9575936794281,-0.212373957037926,-0.105615541338921],[-2.71547174453735,0.339899390935898,-0.719722628593445],[-1.11999690532684,0.673265337944031,-2.63924407958984],[-1.31165075302124,0.753459632396698,-2.38941192626953],[0.400413066148758,0.902173280715942,-1.58194077014923],[1.06597316265106,3.58027625083923,1.90600061416626],[4.56618165969849,-2.43079662322998,0.697836458683014],[4.2729754447937,-2.5679657459259,0.80644679069519],[3.32899951934814,-1.44997847080231,0.246566891670227],[3.03064513206482,-1.84786176681519,-0.154282882809639],[1.90041708946228,-1.2919487953186,-0.601159393787384],[-3.12665748596191,-0.435760140419006,0.158417627215385],[1.42735993862152,0.0395337864756584,-1.10691320896149],[1.7144820690155,2.03149747848511,1.09275341033936],[1.09005117416382,1.03411567211151,1.39296543598175],[0.75717967748642,0.197984218597412,-1.10256361961365],[1.5859854221344,3.24714541435242,2.08960151672363],[1.47113263607025,0.415414959192276,-1.94746458530426],[1.58324754238129,1.77767419815063,-0.141909316182137]],"family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":40},"5":{"id":5,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"4":{"id":4,"type":"background","colors":[[0.298039227724075,0.298039227724075,0.298039227724075,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none"},"6":{"id":6,"type":"background","colors":[[1,1,1,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none"},"8":{"id":8,"type":"bboxdeco","material":{"color":"#000000","front":"lines","back":"lines","fog":false},"vertices":[[-4,null,null],[-2,null,null],[0,null,null],[2,null,null],[4,null,null],[null,-2,null],[null,-1,null],[null,0,null],[null,1,null],[null,2,null],[null,3,null],[null,null,-2],[null,null,-1],[null,null,0],[null,null,1],[null,null,2]],"colors":[[0,0,0,1]],"draw_front":true,"newIds":[20,21,22,23,24,25,26]},"1":{"id":1,"type":"subscene","par3d":{"antialias":8,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,30.3276348114014],"modelMatrix":[[0.756937205791473,0,0,0.00604026019573212],[0,0.385214060544968,1.37604308128357,0.183187812566757],[0,-1.05836689472198,0.500838756561279,-29.6542949676514],[0,0,0,1]],"projMatrix":[[3.73205089569092,0,0,0],[0,3.73205089569092,0,0],[0,0,-3.86370325088501,-109.327613830566],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"scale":[0.756937205791473,1.12629055976868,1.46435451507568],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[-4.73461389541626,4.71865367889404,-2.6704363822937,3.68274688720703,-2.71805810928345,2.16841554641724],"windowRect":[5120,765,5376,1021],"family":"sans","font":1,"cex":1,"useFreeType":true,"fontname":"/Users/JLP/R_libs/rgl/fonts/FreeSans.ttf","maxClipPlanes":6},"embeddings":{"viewport":"replace","projection":"replace","model":"replace"},"objects":[6,8,7,9,10,11,12,5,20,21,22,23,24,25,26],"subscenes":[],"flags":1195},"20":{"id":20,"type":"lines","material":{"lit":false,"front":"lines","back":"lines"},"vertices":[[-4,-2.76573419570923,-2.79135513305664],[4,-2.76573419570923,-2.79135513305664],[-4,-2.76573419570923,-2.79135513305664],[-4,-2.92932868003845,-2.91718196868896],[-2,-2.76573419570923,-2.79135513305664],[-2,-2.92932868003845,-2.91718196868896],[0,-2.76573419570923,-2.79135513305664],[0,-2.92932868003845,-2.91718196868896],[2,-2.76573419570923,-2.79135513305664],[2,-2.92932868003845,-2.91718196868896],[4,-2.76573419570923,-2.79135513305664],[4,-2.92932868003845,-2.91718196868896]],"colors":[[0,0,0,1]],"centers":[[0,-2.76573419570923,-2.79135513305664],[-4,-2.84753131866455,-2.8542685508728],[-2,-2.84753131866455,-2.8542685508728],[0,-2.84753131866455,-2.8542685508728],[2,-2.84753131866455,-2.8542685508728],[4,-2.84753131866455,-2.8542685508728]],"ignoreExtent":true,"origId":8,"flags":128},"21":{"id":21,"type":"text","material":{"lit":false,"front":"lines","back":"lines"},"vertices":[[-4,-3.2565176486969,-3.16883540153503],[-2,-3.2565176486969,-3.16883540153503],[0,-3.2565176486969,-3.16883540153503],[2,-3.2565176486969,-3.16883540153503],[4,-3.2565176486969,-3.16883540153503]],"colors":[[0,0,0,1]],"texts":[["-4"],["-2"],["0"],["2"],["4"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-4,-3.2565176486969,-3.16883540153503],[-2,-3.2565176486969,-3.16883540153503],[0,-3.2565176486969,-3.16883540153503],[2,-3.2565176486969,-3.16883540153503],[4,-3.2565176486969,-3.16883540153503]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":8,"flags":40},"22":{"id":22,"type":"lines","material":{"lit":false,"front":"lines","back":"lines"},"vertices":[[-4.87641286849976,-2,-2.79135513305664],[-4.87641286849976,3,-2.79135513305664],[-4.87641286849976,-2,-2.79135513305664],[-5.11983442306519,-2,-2.91718196868896],[-4.87641286849976,-1,-2.79135513305664],[-5.11983442306519,-1,-2.91718196868896],[-4.87641286849976,0,-2.79135513305664],[-5.11983442306519,0,-2.91718196868896],[-4.87641286849976,1,-2.79135513305664],[-5.11983442306519,1,-2.91718196868896],[-4.87641286849976,2,-2.79135513305664],[-5.11983442306519,2,-2.91718196868896],[-4.87641286849976,3,-2.79135513305664],[-5.11983442306519,3,-2.91718196868896]],"colors":[[0,0,0,1]],"centers":[[-4.87641286849976,0.5,-2.79135513305664],[-4.99812364578247,-2,-2.8542685508728],[-4.99812364578247,-1,-2.8542685508728],[-4.99812364578247,0,-2.8542685508728],[-4.99812364578247,1,-2.8542685508728],[-4.99812364578247,2,-2.8542685508728],[-4.99812364578247,3,-2.8542685508728]],"ignoreExtent":true,"origId":8,"flags":128},"23":{"id":23,"type":"text","material":{"lit":false,"front":"lines","back":"lines"},"vertices":[[-5.6066780090332,-2,-3.16883540153503],[-5.6066780090332,-1,-3.16883540153503],[-5.6066780090332,0,-3.16883540153503],[-5.6066780090332,1,-3.16883540153503],[-5.6066780090332,2,-3.16883540153503],[-5.6066780090332,3,-3.16883540153503]],"colors":[[0,0,0,1]],"texts":[["-2"],["-1"],["0"],["1"],["2"],["3"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-5.6066780090332,-2,-3.16883540153503],[-5.6066780090332,-1,-3.16883540153503],[-5.6066780090332,0,-3.16883540153503],[-5.6066780090332,1,-3.16883540153503],[-5.6066780090332,2,-3.16883540153503],[-5.6066780090332,3,-3.16883540153503]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":8,"flags":40},"24":{"id":24,"type":"lines","material":{"lit":false,"front":"lines","back":"lines"},"vertices":[[-4.87641286849976,-2.76573419570923,-2],[-4.87641286849976,-2.76573419570923,2],[-4.87641286849976,-2.76573419570923,-2],[-5.11983442306519,-2.92932868003845,-2],[-4.87641286849976,-2.76573419570923,-1],[-5.11983442306519,-2.92932868003845,-1],[-4.87641286849976,-2.76573419570923,0],[-5.11983442306519,-2.92932868003845,0],[-4.87641286849976,-2.76573419570923,1],[-5.11983442306519,-2.92932868003845,1],[-4.87641286849976,-2.76573419570923,2],[-5.11983442306519,-2.92932868003845,2]],"colors":[[0,0,0,1]],"centers":[[-4.87641286849976,-2.76573419570923,0],[-4.99812364578247,-2.84753131866455,-2],[-4.99812364578247,-2.84753131866455,-1],[-4.99812364578247,-2.84753131866455,0],[-4.99812364578247,-2.84753131866455,1],[-4.99812364578247,-2.84753131866455,2]],"ignoreExtent":true,"origId":8,"flags":128},"25":{"id":25,"type":"text","material":{"lit":false,"front":"lines","back":"lines"},"vertices":[[-5.6066780090332,-3.2565176486969,-2],[-5.6066780090332,-3.2565176486969,-1],[-5.6066780090332,-3.2565176486969,0],[-5.6066780090332,-3.2565176486969,1],[-5.6066780090332,-3.2565176486969,2]],"colors":[[0,0,0,1]],"texts":[["-2"],["-1"],["0"],["1"],["2"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-5.6066780090332,-3.2565176486969,-2],[-5.6066780090332,-3.2565176486969,-1],[-5.6066780090332,-3.2565176486969,0],[-5.6066780090332,-3.2565176486969,1],[-5.6066780090332,-3.2565176486969,2]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":8,"flags":40},"26":{"id":26,"type":"lines","material":{"lit":false,"front":"lines","back":"lines"},"vertices":[[-4.87641286849976,-2.76573419570923,-2.79135513305664],[-4.87641286849976,3.77804470062256,-2.79135513305664],[-4.87641286849976,-2.76573419570923,2.24171257019043],[-4.87641286849976,3.77804470062256,2.24171257019043],[-4.87641286849976,-2.76573419570923,-2.79135513305664],[-4.87641286849976,-2.76573419570923,2.24171257019043],[-4.87641286849976,3.77804470062256,-2.79135513305664],[-4.87641286849976,3.77804470062256,2.24171257019043],[-4.87641286849976,-2.76573419570923,-2.79135513305664],[4.86045265197754,-2.76573419570923,-2.79135513305664],[-4.87641286849976,-2.76573419570923,2.24171257019043],[4.86045265197754,-2.76573419570923,2.24171257019043],[-4.87641286849976,3.77804470062256,-2.79135513305664],[4.86045265197754,3.77804470062256,-2.79135513305664],[-4.87641286849976,3.77804470062256,2.24171257019043],[4.86045265197754,3.77804470062256,2.24171257019043],[4.86045265197754,-2.76573419570923,-2.79135513305664],[4.86045265197754,3.77804470062256,-2.79135513305664],[4.86045265197754,-2.76573419570923,2.24171257019043],[4.86045265197754,3.77804470062256,2.24171257019043],[4.86045265197754,-2.76573419570923,-2.79135513305664],[4.86045265197754,-2.76573419570923,2.24171257019043],[4.86045265197754,3.77804470062256,-2.79135513305664],[4.86045265197754,3.77804470062256,2.24171257019043]],"colors":[[0,0,0,1]],"centers":[[-4.87641286849976,0.506155252456665,-2.79135513305664],[-4.87641286849976,0.506155252456665,2.24171257019043],[-4.87641286849976,-2.76573419570923,-0.274821281433105],[-4.87641286849976,3.77804470062256,-0.274821281433105],[-0.0079801082611084,-2.76573419570923,-2.79135513305664],[-0.0079801082611084,-2.76573419570923,2.24171257019043],[-0.0079801082611084,3.77804470062256,-2.79135513305664],[-0.0079801082611084,3.77804470062256,2.24171257019043],[4.86045265197754,0.506155252456665,-2.79135513305664],[4.86045265197754,0.506155252456665,2.24171257019043],[4.86045265197754,-2.76573419570923,-0.274821281433105],[4.86045265197754,3.77804470062256,-0.274821281433105]],"ignoreExtent":true,"origId":8,"flags":128}},"width":720,"height":720,"sphereVerts":{"material":[],"it":[[0,6,7,19,4,8,6,22,2,7,8,25,7,6,8,26,0,7,9,27,2,10,7,24,5,9,10,32,9,7,10,33,0,11,6,18,3,12,11,37,4,6,12,39,6,11,12,40,0,9,11,34,5,13,9,31,3,11,13,44,11,9,13,45,1,14,15,47,2,8,14,49,4,15,8,21,15,14,8,52,1,16,14,46,5,10,16,55,2,14,10,29,14,16,10,57,1,15,17,58,4,12,15,51,3,17,12,36,17,15,12,62,1,17,16,53,3,13,17,61,5,16,13,42,16,17,13,65],[18,20,19,18,21,23,22,21,24,26,25,24,20,23,26,20,19,28,27,19,29,30,24,29,31,33,32,31,28,30,33,28,34,35,18,34,36,38,37,36,22,40,39,22,35,38,40,35,27,41,34,27,42,43,31,42,37,45,44,37,41,43,45,41,46,48,47,46,25,50,49,25,51,52,21,51,48,50,52,48,53,54,46,53,32,56,55,32,49,57,29,49,54,56,57,54,47,59,58,47,39,60,51,39,61,62,36,61,59,60,62,59,58,63,53,58,44,64,61,44,55,65,42,55,63,64,65,63],[19,18,20,20,22,21,23,23,25,24,26,26,26,20,23,23,27,19,28,28,24,29,30,30,32,31,33,33,33,28,30,30,18,34,35,35,37,36,38,38,39,22,40,40,40,35,38,38,34,27,41,41,31,42,43,43,44,37,45,45,45,41,43,43,47,46,48,48,49,25,50,50,21,51,52,52,52,48,50,50,46,53,54,54,55,32,56,56,29,49,57,57,57,54,56,56,58,47,59,59,51,39,60,60,36,61,62,62,62,59,60,60,53,58,63,63,61,44,64,64,42,55,65,65,65,63,64,64]],"vb":[[-1,1,0,0,0,0,-0.707106781186548,-0.707106781186548,0,-0.707106781186548,0,-0.707106781186548,0,0,0.707106781186548,0.707106781186548,0.707106781186548,0.707106781186548,-0.934997526317783,-0.934997526317783,-0.770440042047682,0,-0.354654234120539,-0.450789386304495,-0.354654234120539,0,-0.450789386304495,-0.934997526317783,-0.770440042047682,0,-0.450789386304495,-0.354654234120539,0,-0.450789386304495,-0.934997526317783,-0.770440042047682,0,-0.354654234120539,-0.450789386304495,0,-0.450789386304495,-0.770440042047682,0,-0.450789386304495,0,-0.450789386304495,0.934997526317783,0.934997526317783,0.770440042047682,0.354654234120539,0.450789386304495,0.354654234120539,0.450789386304495,0.934997526317783,0.770440042047682,0.354654234120539,0.450789386304495,0.450789386304495,0.934997526317783,0.770440042047682,0.450789386304495,0.354654234120539,0.450789386304495,0.770440042047682,0.450789386304495,0.450789386304495],[0,0,-1,1,0,0,0,-0.707106781186548,-0.707106781186548,0,-0.707106781186548,0.707106781186548,0.707106781186548,0.707106781186548,-0.707106781186548,0,0,0.707106781186548,0,-0.354654234120539,-0.450789386304495,-0.354654234120539,0,-0.450789386304495,-0.934997526317783,-0.934997526317783,-0.770440042047682,0,-0.450789386304495,-0.934997526317783,-0.770440042047682,0,-0.354654234120539,-0.450789386304495,0.354654234120539,0.450789386304495,0.934997526317783,0.934997526317783,0.770440042047682,0.354654234120539,0.450789386304495,0.450789386304495,0.354654234120539,0.450789386304495,0.934997526317783,0.770440042047682,-0.354654234120539,0,-0.450789386304495,-0.934997526317783,-0.770440042047682,0,-0.450789386304495,0,-0.450789386304495,0,-0.450789386304495,-0.770440042047682,0.354654234120539,0.450789386304495,0.450789386304495,0.934997526317783,0.770440042047682,0.450789386304495,0.770440042047682,0.450789386304495],[0,0,0,0,-1,1,-0.707106781186548,0,-0.707106781186548,0.707106781186548,0.707106781186548,0,-0.707106781186548,0.707106781186548,0,-0.707106781186548,0.707106781186548,0,-0.354654234120539,0,-0.450789386304495,-0.934997526317783,-0.934997526317783,-0.770440042047682,0,-0.354654234120539,-0.450789386304495,0.354654234120539,0.450789386304495,0.354654234120539,0.450789386304495,0.934997526317783,0.934997526317783,0.770440042047682,0,-0.450789386304495,-0.354654234120539,0,-0.450789386304495,-0.934997526317783,-0.770440042047682,0.450789386304495,0.934997526317783,0.770440042047682,0.354654234120539,0.450789386304495,0,-0.354654234120539,-0.450789386304495,0,-0.450789386304495,-0.934997526317783,-0.770440042047682,0.354654234120539,0.450789386304495,0.934997526317783,0.770440042047682,0.450789386304495,0,-0.450789386304495,-0.770440042047682,0,-0.450789386304495,0.450789386304495,0.450789386304495,0.770440042047682]],"primitivetype":"triangle"}},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->



```r
d1 <- data.frame(type=exType,pca1$x)
#d1 <- data.frame(type=channel.type2[ford],pca1$x)
try(lda.fit <- lda(type ~ ., data=d1),silent=FALSE)
geterrmessage()
```

```
# [1] "Error in lda.default(x, grouping, ...) : \n  variable 24 appears to be constant within groups\n"
```

```r
lda.fit <- lda(type ~ ., data=d1[,1:3])
```

<FONT COLOR=#750000> 
LDA was run using only the first 2 out of 24 principal 
components from the untransformed correlation matrix.
</FONT>  



```r
voronoidf <- data.frame(x=lda.fit$means[,1],y=lda.fit$means[,2])

#This creates the voronoi line segments
plot(d1[,2:3], col=ccol3[ford], pch=20, cex=1.5)

text(d1[,2:3], labels=rownames(d1), pos=ifelse(d1[,2]<4,4,2), 
     col=ccol3[ford], cex=1.2)

deldir(x = voronoidf$x,y = voronoidf$y, rw = c(-5,5,-5,5), 
       plotit=TRUE, add=TRUE, wl='te')
text(voronoidf, labels=rownames(voronoidf), pos=c(1,1,3))
```

<figure><img src="../Figures/MarkerExploration_figure/cc-voronoi-1.png"><figcaption><b>Figure 5: Voronoi diagram on class means from LDA on PCA of untransformed correlation matrix</b><br><br></figcaption></figure>


<footer>
<p> [Back to Top][Data]</p>
</footer>
